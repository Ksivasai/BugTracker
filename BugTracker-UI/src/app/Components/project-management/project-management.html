<div class="container">
  <h2>Project Management</h2>

  <!-- Form for Creating and Editing Projects -->
  <div class="form-card">
    <h3>{{ isEditing ? 'Edit Project' : 'Add New Project' }}</h3>
    <form [formGroup]="projectForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="projectKey">Project Key (e.g., MC, XS)</label>
        <input id="projectKey" type="text" formControlName="projectKey" placeholder="A short, unique key">
      </div>
      <div class="form-group">
        <label for="projectName">Project Name</label>
        <input id="projectName" type="text" formControlName="projectName" placeholder="The full name of the project">
      </div>

      <div class="button-group">
        <button type="submit" [disabled]="projectForm.invalid">{{ isEditing ? 'Update Project' : 'Create Project' }}</button>
        @if(isEditing)
        {
         <button type="button" (click)="resetForm()" class="secondary">Cancel</button>
        }
      </div>

      @if(errorMessage)
      {
        <p class="error-message">{{ errorMessage }}</p>
      }
    </form>
  </div>

  <!-- Table to Display Existing Projects -->
  <div class="table-container">
    <h3>Existing Projects</h3>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Key</th>
          <th>Name</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
       @for (project of projects$ | async; track project.projectId) 
        {
            <tr>
              <td>{{ project.projectId }}</td>
              <td>{{ project.projectKey }}</td>
              <td>{{ project.projectName }}</td>
              <td class="action-buttons">
                <button (click)="editProject(project)" class="edit">Edit</button>
                <button (click)="deleteProject(project.projectId)" class="delete">Delete</button>
              </td>
            </tr>
        }
      </tbody>
    </table>
  </div>
</div>

